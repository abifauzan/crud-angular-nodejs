{"version":3,"file":"dom_animation_transition_engine.js","sources":["../../../../../modules/@angular/animation/src/engine/dom_animation_transition_engine.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AnimationPlayer, Injectable} from '@angular/core';\nimport {StyleData} from '../common/style_data';\nimport {AnimationTimelineInstruction} from '../dsl/animation_timeline_instruction';\nimport {AnimationTransitionInstruction} from '../dsl/animation_transition_instruction';\nimport {AnimationStyleNormalizer} from '../dsl/style_normalization/animation_style_normalizer';\nimport {AnimationGroupPlayer, NoOpAnimationPlayer, TransitionEngine} from '../private_import_core';\n\nimport {AnimationDriver} from './animation_driver';\nimport {AnimationEngineInstruction, AnimationTransitionInstructionType} from './animation_engine_instruction';\n\nexport declare type AnimationPlayerTuple = {\n  element: any; player: AnimationPlayer;\n};\nexport class DomAnimationTransitionEngine extends TransitionEngine {\nprivate _flaggedInserts = new Set<any>();\nprivate _queuedRemovals: any[] = [];\nprivate _queuedAnimations: AnimationPlayerTuple[] = [];\nprivate _activeElementAnimations = new Map<any, AnimationPlayer[]>();\nprivate _activeTransitionAnimations = new Map<any, {[triggerName: string]: AnimationPlayer}>();\n/**\n * @param {?} _driver\n * @param {?} _normalizer\n */\nconstructor(private _driver: AnimationDriver,\nprivate _normalizer: AnimationStyleNormalizer) {\n    super();\n  }\n/**\n * @param {?} container\n * @param {?} element\n * @return {?}\n */\ninsertNode(container: any, element: any) {\n    container.appendChild(element);\n    this._flaggedInserts.add(element);\n  }\n/**\n * @param {?} element\n * @return {?}\n */\nremoveNode(element: any) { this._queuedRemovals.push(element); }\n/**\n * @param {?} element\n * @param {?} instructions\n * @return {?}\n */\nprocess(element: any, instructions: AnimationEngineInstruction[]): AnimationPlayer {\n    const /** @type {?} */ players = instructions.map(instruction => {\n      if (instruction.type == AnimationTransitionInstructionType.TransitionAnimation) {\n        return this._handleTransitionAnimation(\n            element, /** @type {?} */(( <AnimationTransitionInstruction>instruction)));\n      }\n      if (instruction.type == AnimationTransitionInstructionType.TimelineAnimation) {\n        return this._handleTimelineAnimation(\n            element, /** @type {?} */(( <AnimationTimelineInstruction>instruction)), []);\n      }\n      return new NoOpAnimationPlayer();\n    });\n    return optimizeGroupPlayer(players);\n  }\n/**\n * @param {?} element\n * @param {?} instruction\n * @return {?}\n */\nprivate _handleTransitionAnimation(element: any, instruction: AnimationTransitionInstruction):\n      AnimationPlayer {\n    const /** @type {?} */ triggerName = instruction.triggerName;\n    const /** @type {?} */ elmTransitionMap = getOrSetAsInMap(this._activeTransitionAnimations, element, {});\n\n    let /** @type {?} */ previousPlayers: AnimationPlayer[];\n    if (instruction.isRemovalTransition) {\n      // we make a copy of the array because the actual source array is modified\n      // each time a player is finished/destroyed (the forEach loop would fail otherwise)\n      previousPlayers = copyArray(this._activeElementAnimations.get(element));\n    } else {\n      previousPlayers = [];\n      const /** @type {?} */ existingPlayer = elmTransitionMap[triggerName];\n      if (existingPlayer) {\n        previousPlayers.push(existingPlayer);\n      }\n    }\n\n    // it's important to do this step before destroying the players\n    // so that the onDone callback below won't fire before this\n    eraseStyles(element, instruction.fromStyles);\n\n    // we first run this so that the previous animation player\n    // data can be passed into the successive animation players\n    const /** @type {?} */ players = instruction.timelines.map(\n        timelineInstruction => this._buildPlayer(element, timelineInstruction, previousPlayers));\n\n    previousPlayers.forEach(previousPlayer => previousPlayer.destroy());\n\n    const /** @type {?} */ player = optimizeGroupPlayer(players);\n    player.onDone(() => {\n      player.destroy();\n      const /** @type {?} */ elmTransitionMap = this._activeTransitionAnimations.get(element);\n      if (elmTransitionMap) {\n        delete elmTransitionMap[triggerName];\n        if (Object.keys(elmTransitionMap).length == 0) {\n          this._activeTransitionAnimations.delete(element);\n        }\n      }\n      deleteFromArrayMap(this._activeElementAnimations, element, player);\n      setStyles(element, instruction.toStyles);\n    });\n\n    this._queuePlayer(element, player);\n    elmTransitionMap[triggerName] = player;\n\n    return player;\n  }\n/**\n * @param {?} element\n * @param {?} instruction\n * @param {?} previousPlayers\n * @return {?}\n */\nprivate _handleTimelineAnimation(\n      element: any, instruction: AnimationTimelineInstruction,\n      previousPlayers: AnimationPlayer[]): AnimationPlayer {\n    const /** @type {?} */ player = this._buildPlayer(element, instruction, previousPlayers);\n    player.onDestroy(() => { deleteFromArrayMap(this._activeElementAnimations, element, player); });\n    this._queuePlayer(element, player);\n    return player;\n  }\n/**\n * @param {?} element\n * @param {?} instruction\n * @param {?} previousPlayers\n * @return {?}\n */\nprivate _buildPlayer(\n      element: any, instruction: AnimationTimelineInstruction,\n      previousPlayers: AnimationPlayer[]): AnimationPlayer {\n    return this._driver.animate(\n        element, this._normalizeKeyframes(instruction.keyframes), instruction.duration,\n        instruction.delay, instruction.easing, previousPlayers);\n  }\n/**\n * @param {?} keyframes\n * @return {?}\n */\nprivate _normalizeKeyframes(keyframes: StyleData[]): StyleData[] {\n    const /** @type {?} */ errors: string[] = [];\n    const /** @type {?} */ normalizedKeyframes: StyleData[] = [];\n    keyframes.forEach(kf => {\n      const /** @type {?} */ normalizedKeyframe: StyleData = {};\n      Object.keys(kf).forEach(prop => {\n        let /** @type {?} */ normalizedProp = prop;\n        let /** @type {?} */ normalizedValue = kf[prop];\n        if (prop != 'offset') {\n          normalizedProp = this._normalizer.normalizePropertyName(prop, errors);\n          normalizedValue =\n              this._normalizer.normalizeStyleValue(prop, normalizedProp, kf[prop], errors);\n        }\n        normalizedKeyframe[normalizedProp] = normalizedValue;\n      });\n      normalizedKeyframes.push(normalizedKeyframe);\n    });\n    if (errors.length) {\n      const /** @type {?} */ LINE_START = '\\n - ';\n      throw new Error(\n          `Unable to animate due to the following errors:${LINE_START}${errors.join(LINE_START)}`);\n    }\n    return normalizedKeyframes;\n  }\n/**\n * @param {?} element\n * @param {?} player\n * @return {?}\n */\nprivate _queuePlayer(element: any, player: AnimationPlayer) {\n    const /** @type {?} */ tuple = /** @type {?} */(( <AnimationPlayerTuple>{element, player}));\n    this._queuedAnimations.push(tuple);\n    player.init();\n\n    const /** @type {?} */ elementAnimations = getOrSetAsInMap(this._activeElementAnimations, element, []);\n    elementAnimations.push(player);\n  }\n/**\n * @return {?}\n */\ntriggerAnimations() {\n    while (this._queuedAnimations.length) {\n      const {player, element} = this._queuedAnimations.shift();\n      // in the event that an animation throws an error then we do\n      // not want to re-run animations on any previous animations\n      // if they have already been kicked off beforehand\n      if (!player.hasStarted()) {\n        player.play();\n      }\n    }\n\n    this._queuedRemovals.forEach(element => {\n      if (this._flaggedInserts.has(element)) return;\n\n      let /** @type {?} */ parent = element;\n      let /** @type {?} */ players: AnimationPlayer[];\n      while (parent = parent.parentNode) {\n        const /** @type {?} */ match = this._activeElementAnimations.get(parent);\n        if (match) {\n          players = match;\n          break;\n        }\n      }\n      if (players) {\n        optimizeGroupPlayer(players).onDone(() => remove(element));\n      } else {\n        if (element.parentNode) {\n          remove(element);\n        }\n      }\n    });\n\n    this._queuedRemovals = [];\n    this._flaggedInserts.clear();\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: AnimationDriver, },\n{type: AnimationStyleNormalizer, },\n];\n}\n\nfunction DomAnimationTransitionEngine_tsickle_Closure_declarations() {\n/** @type {?} */\nDomAnimationTransitionEngine.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nDomAnimationTransitionEngine.ctorParameters;\n/** @type {?} */\nDomAnimationTransitionEngine.prototype._flaggedInserts;\n/** @type {?} */\nDomAnimationTransitionEngine.prototype._queuedRemovals;\n/** @type {?} */\nDomAnimationTransitionEngine.prototype._queuedAnimations;\n/** @type {?} */\nDomAnimationTransitionEngine.prototype._activeElementAnimations;\n/** @type {?} */\nDomAnimationTransitionEngine.prototype._activeTransitionAnimations;\n/** @type {?} */\nDomAnimationTransitionEngine.prototype._driver;\n/** @type {?} */\nDomAnimationTransitionEngine.prototype._normalizer;\n}\n\n/**\n * @param {?} map\n * @param {?} key\n * @param {?} defaultValue\n * @return {?}\n */\nfunction getOrSetAsInMap(map: Map<any, any>, key: any, defaultValue: any) {\n  let /** @type {?} */ value = map.get(key);\n  if (!value) {\n    map.set(key, value = defaultValue);\n  }\n  return value;\n}\n/**\n * @param {?} map\n * @param {?} key\n * @param {?} value\n * @return {?}\n */\nfunction deleteFromArrayMap(map: Map<any, any[]>, key: any, value: any) {\n  let /** @type {?} */ arr = map.get(key);\n  if (arr) {\n    const /** @type {?} */ index = arr.indexOf(value);\n    if (index >= 0) {\n      arr.splice(index, 1);\n      if (arr.length == 0) {\n        map.delete(key);\n      }\n    }\n  }\n}\n/**\n * @param {?} element\n * @param {?} styles\n * @return {?}\n */\nfunction setStyles(element: any, styles: StyleData) {\n  Object.keys(styles).forEach(prop => { element.style[prop] = styles[prop]; });\n}\n/**\n * @param {?} element\n * @param {?} styles\n * @return {?}\n */\nfunction eraseStyles(element: any, styles: StyleData) {\n  Object.keys(styles).forEach(prop => {\n    // IE requires '' instead of null\n    // see https://github.com/angular/angular/issues/7916\n    element.style[prop] = '';\n  });\n}\n/**\n * @param {?} players\n * @return {?}\n */\nfunction optimizeGroupPlayer(players: AnimationPlayer[]): AnimationPlayer {\n  return players.length == 1 ? players[0] : new AnimationGroupPlayer(players);\n}\n/**\n * @param {?} source\n * @return {?}\n */\nfunction copyArray(source: any[]): any[] {\n  return source ? source.splice(0) : [];\n}\n/**\n * @param {?} element\n * @return {?}\n */\nfunction remove(element: any) {\n  element.parentNode.removeChild(element);\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}